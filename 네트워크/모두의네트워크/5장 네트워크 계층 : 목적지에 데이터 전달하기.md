# 17 네트워크 계층의 역할

데이터 링크 계층에서는 이더넷 규칙을 기반으로 데이터의 전송을 담당한다. 이 규칙에 따라 같은 네트워크에 있는 컴퓨터로는 데이터를 전송할 수 있지만 인터넷이나 다른 나트워크로는 전송할 수 없다. 다른 네트워크에 있는 목적지로 데이터를 전달하려면 네트워크 계층의 기술이 필요하다.

### 라우터

다른 네트워크로 데이터를 전송하려면 필요한 장비

데이터의 목적지가 정해지면 해당 목적지까지 어떤 경로로 가는 것이 좋은지를 알려주는 기능을 한다.

### IP 주소

네트워크를 식별할 수 있는 주소로 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있도록 하는 주소. IP 주소가 있으면 다른 네트워크에 있는 목적지를 지정할 수 있다.

### 라우팅

경로를 선택하고, 목적지 IP 주소까지 어떻게 데이터를 전달할지 결정하는 것

라우터를 사용하여 거리에 관계없이 다른 네트워크로 데이터를 보낼 수 있다. 라우터에는 **라우팅 테이블**이 있어서 경로 정보를 등록하고 관리한다.

### IP란?

네트워크 계층에는 Internet Protocol이라는 프로토콜이 있다. 네트워크 계층에서는 캡슐화를 할 때 IP 헤더를 붙인다. 헤더에는 다음의 정보가 들어 있다.

1. 버전
2. 헤더 길이
3. 서비스 유형
4. 전체 패킷 길이
5. ID(일련번호)
6. 조각 상태
7. 조각의 위치
8. TTL
9. 프로토콜
10. 헤더 체크섬
11. **출발지 IP주소**
12. **목적지 IP주소**

### IP 패킷

캡슐화할 때 데이터에 추가되는 IP 헤더

# 18 IP 주소의 구조

### IPv4와 IPv6

|종류|길이|개수|
|---|---|---|
|IPv4|32비트|약 43억 개|
|IPv6|128비트|약 340간 개(=340조의 1조 배의 1조 배)|

### 공인 IP 주소와 사설 IP 주소

사용할 수 있는 주소의 수가 고갈되고 있는 이유로, 인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP 주소를 할당하고, 회사나 가정의 랜에 있는 컴퓨터는 사설 IP 주소를 할당하는 정책을 사용한다.

![https://user-images.githubusercontent.com/57691894/130242439-d7f849dd-501e-4f08-86ac-b4da9defd00a.png](https://user-images.githubusercontent.com/57691894/130242439-d7f849dd-501e-4f08-86ac-b4da9defd00a.png)

랜 안에 컴퓨터가 여러 대 있다면 공인 IP 주소는 사용할 수 있는 숫자가 제한되므로 컴퓨터 한 대당 공인 IP 주소를 하나씩 할당하기 어렵다. 그래서 우선 인터넷 서비스 공급자(ISP)가 제공하는 공인 IP 주소는 라우터에만 할당하고 랜 안에 있는 컴퓨터에는 랜의 네트워크 관리자가 자유롭게 사설 IP 주소를 할당하거나 라우터의 DHCP 기능을 사용하여 주소를 자동으로 할당한다.

- **DHCP** (Dynamic Host Configuration Protocol) : IP 주소를 자동으로 할당하는 프로토콜

### IP 주소 구조

|1옥텟|2옥텟|3옥텟|4옥텟|
|:---:|:---:|:---:|:---:|
|[11000000]|[10101000]|[00000001]|[00001010]|
|8비트|8비트|8비트|8비트|
|192|168|0|1|

IP 주소는 10진수로 표기하지만 실제로는 2진수로 되어 있다. 32비트를 8비트씩 끊어서 네 개의 옥텟으로 구분하고 있고, 숫자의 범위도 정해져 있다. (10진수로는 0 ~ 255)

- **네트워크 ID :** 어떤 네트워크인지를 나타낸다
- **호스트 ID** : 해당 네트워크의 어느 컴퓨터인지를 나타낸다

→ 이 두 가지의 정보가 합쳐저서 IP 주소가 된다.

# 19 IP 주소의 클래스 구조

네트워크 크기는 **클래스**라는 개념으로 구분한다

|클래스 이름|내용|네트워크 ID|호스트 ID|범위|
|:---:|:---:|:---:|:---:|:---:|
|A클래스|대규모 네트워크 주소| [00000001]<br/>8비트 | [00000000][00000000][00000000]<br/>24비트 | 1.0.0.0<br/> ~ 127.255.255.255 |
|B클래스|중형 네트워크 주소| [10000000][00000000]<br/>16비트 | [00000000][00000000]<br/>16비트 | 128.0.0.0<br/> ~ 191.255.255.255 |
|C클래스|소규모 네트워크 주소| [10000000][00000000][00000000]<br/>24비트|[00000000]<br/>8비트 | 192.0.0.0<br/> ~ 223.255.255.255 |
|D클래스|멀티캐스트 주소| - | - | 
|E클래스|연구 및 특수용도 주소| - | - |

- 일반 네트워크에서는 A~C 클래스까지 사용할 수 있다.
- IP 주소의 클래스별 호스트 수는 A 클래스가 1677만 7214대, B 클래스가 6만 5534대, C 클래스가 254대다.

|클래스 이름|공인 IP 주소의 범위|사설 IP 주소의 범위|
|:---:|:---:|:---:|
|A클래스|1.0.0.0 ~ 9.255.255.255 <br/> 11.0.0.0 ~ 126.255.255.255 | 10.0.0.0 ~ 10.25.255.255 |
|B클래스|128.0.0.0 ~ 172.15.255.255 <br/> 172.32.0.0 ~ 191.255.255.255 | 172.16.0.0 ~ 172.31.255.255 |
|C클래스|192.0.0.0 ~ 192.167.255.255 <br/> 192.169.0.0 ~ 223.255.255.255 | 192.168.0.0 ~ 192.168.255.255 |
