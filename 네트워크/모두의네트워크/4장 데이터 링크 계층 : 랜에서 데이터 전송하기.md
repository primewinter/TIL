# 12 데이터 링크 계층의 역할과 이더넷

### 데이터링크 계층

네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층

### 이더넷

규칙들 중 일반적으로 가장 많이 사용되는 규칙으로, 허브 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용한다.

### CSMA/CD

**Carrier Sense Multiple Access with Collision Detection(반송파 감지 다중 접속 및 충돌 탐지)**

컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 서로 부딪혀서 충돌(collision)이 발생할 수 있다. 이를 피하기 위해 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않기 위한 규칙으로 CSMA/CD 방식을 사용한다.

**CS :** 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지를 확인한다는 규칙

**MA :** 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다는 규칙

**CD** : 충돌이 발생하고 있는지를 확인한다는 규칙

# 13 MAC 주소의 구조

### MAC 주소

**Media Access Control Address(물리 주소)**

비트열(0과 1)을 전기 신호로 변환하는 랜카드에는 MAC 주소라는 번호가 정해져 있다. 제조할 때 새겨지기 때문에 물리 주소라고도 불리는데 전 세계에서 유일한 번호로 할당되어 있다.

MAC주소 (48비트 숫자) = 제조사 번호 24비트 + 제조사가 붙인 일련번호 24비트

### 프레임

OSI 모델에서는 데이터 링크 계층, TCP/IP 모델에서는 네트워크 계층에서 이더넷 헤더와 트레일러를 붙이는데, **이더넷 헤더와 트레일러가 추가된 데이터**를 프레임이라고 한다.

### **이더넷 헤더**

총 14바이트 = 목적지 MAC 주소(6바이트) + 출발지 MAC 주소(6바이트) + 유형(2바이트)

### 유형(Ethernet type)

이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타낸다. 유형 번호를 기억할 필요는 없지만 유형에 **프로토콜 종류를 식별하는 번호가 들어간다**는 내용만 기억하자. 16진수 번호가 들어간다.

### **트레일러**

FCS(Frame Check Sequence)라고도 하며, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용한다. 데이터 링크 계층에서 데이터 뒤에 추가하는 것을 말한다.

### 컴퓨터1에서 컴퓨터3으로 데이터가 전송되는 과정

![https://user-images.githubusercontent.com/57691894/129660160-f3c49aa6-7c0a-444e-8728-5b1be12f3df1.png](https://user-images.githubusercontent.com/57691894/129660160-f3c49aa6-7c0a-444e-8728-5b1be12f3df1.png)

1. 컴퓨터1은 이더넷 헤더에 컴퓨터3의 MAC주소(목적지 MAC주소)와 자신의 MAC주소(출발지 MAC 주소) 정보를 넣고 데이터를 전송한다. 
2. 보내는 측의 컴퓨터1에서 **캡슐화**가 일어난다. 데이터 링크 계층에서 데이터에 이더넷헤더와 트레일러를 추가하여 프레임을 만든다. 물리 계층에서 이 프레임 비트열을 전기 신호로 변환하고 네트워크를 통해 전송한다.
3. 허브는 컴퓨터1이 보낸 데이터를 1포트로 수신하고 2~4의 모든 포트로 전송한다.
4. 컴퓨터2, 4는 자신의 MAC주소와 목적지 MAC주소가 다르기 때문에 데이터를 파기한다.
5. 컴퓨터3에서는 **역캡슐화(**물리 계층에서 전기 신호로 전송된 데이터를 비트열로 변환하고 데이터 링크 계층에서 이더넷 헤더와 트레일러를 분리한다)를 한 다음에 데이터를 수신한다. 

### 만약 컴퓨터1과 2가 동시에 컴퓨터3에 데이터를 전송한다면?

이때 충돌을 방지하기 위해 CSMA/CD 방식이 사용되어, 충돌이 감지되면 컴퓨터2는 잠시 대기하고 데이터를 다시 전송한다.
