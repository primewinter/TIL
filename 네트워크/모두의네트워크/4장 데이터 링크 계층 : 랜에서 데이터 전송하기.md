# 12 데이터 링크 계층의 역할과 이더넷

### 데이터링크 계층

네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층

### 이더넷

규칙들 중 일반적으로 가장 많이 사용되는 규칙으로, 허브 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용한다.

### CSMA/CD

**Carrier Sense Multiple Access with Collision Detection(반송파 감지 다중 접속 및 충돌 탐지)**

컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 서로 부딪혀서 충돌(collision)이 발생할 수 있다. 이를 피하기 위해 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않기 위한 규칙으로 CSMA/CD 방식을 사용한다.

**CS :** 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지를 확인한다는 규칙

**MA :** 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다는 규칙

**CD** : 충돌이 발생하고 있는지를 확인한다는 규칙

# 13 MAC 주소의 구조

### MAC 주소

**Media Access Control Address(물리 주소)**

비트열(0과 1)을 전기 신호로 변환하는 랜카드에는 MAC 주소라는 번호가 정해져 있다. 제조할 때 새겨지기 때문에 물리 주소라고도 불리는데 전 세계에서 유일한 번호로 할당되어 있다.

MAC주소 (48비트 숫자) = 제조사 번호 24비트 + 제조사가 붙인 일련번호 24비트

### 프레임

OSI 모델에서는 데이터 링크 계층, TCP/IP 모델에서는 네트워크 계층에서 이더넷 헤더와 트레일러를 붙이는데, **이더넷 헤더와 트레일러가 추가된 데이터**를 프레임이라고 한다.

### **이더넷 헤더**

총 14바이트 = 목적지 MAC 주소(6바이트) + 출발지 MAC 주소(6바이트) + 유형(2바이트)

### 유형(Ethernet type)

이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타낸다. 유형 번호를 기억할 필요는 없지만 유형에 **프로토콜 종류를 식별하는 번호가 들어간다**는 내용만 기억하자. 16진수 번호가 들어간다.

### **트레일러**

FCS(Frame Check Sequence)라고도 하며, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용한다. 데이터 링크 계층에서 데이터 뒤에 추가하는 것을 말한다.

### 컴퓨터1에서 컴퓨터3으로 데이터가 전송되는 과정

![https://user-images.githubusercontent.com/57691894/129660160-f3c49aa6-7c0a-444e-8728-5b1be12f3df1.png](https://user-images.githubusercontent.com/57691894/129660160-f3c49aa6-7c0a-444e-8728-5b1be12f3df1.png)

1. 컴퓨터1은 이더넷 헤더에 컴퓨터3의 MAC주소(목적지 MAC주소)와 자신의 MAC주소(출발지 MAC 주소) 정보를 넣고 데이터를 전송한다. 
2. 보내는 측의 컴퓨터1에서 **캡슐화**가 일어난다. 데이터 링크 계층에서 데이터에 이더넷헤더와 트레일러를 추가하여 프레임을 만든다. 물리 계층에서 이 프레임 비트열을 전기 신호로 변환하고 네트워크를 통해 전송한다.
3. 허브는 컴퓨터1이 보낸 데이터를 1포트로 수신하고 2~4의 모든 포트로 전송한다.
4. 컴퓨터2, 4는 자신의 MAC주소와 목적지 MAC주소가 다르기 때문에 데이터를 파기한다.
5. 컴퓨터3에서는 **역캡슐화(**물리 계층에서 전기 신호로 전송된 데이터를 비트열로 변환하고 데이터 링크 계층에서 이더넷 헤더와 트레일러를 분리한다)를 한 다음에 데이터를 수신한다. 

### 만약 컴퓨터1과 2가 동시에 컴퓨터3에 데이터를 전송한다면?

이때 충돌을 방지하기 위해 CSMA/CD 방식이 사용되어, 충돌이 감지되면 컴퓨터2는 잠시 대기하고 데이터를 다시 전송한다.


# 14 스위치의 구조

### 스위치

데이터 링크 계층에서 동작하고 레이어 2 스위치 또는 스위칭 허브라고 불린다. 스위치 내부에는 **MAC 주소 테이블**이 있어서 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC 주소가 등록된다.

### MAC 주소 학습 기능

컴퓨터에서 목적지 MAC 주소가 추가된 프레임이라는 데이터가 전송되면 MAC 주소 테이블을 확인하고 출발지 MAC 주소가 등록되어 있지 않으면 MAC 주소를 포트와 함께 등록한다.

![https://user-images.githubusercontent.com/57691894/129868348-6b5a3175-dfd9-46d6-ba24-d581a7050268.png](https://user-images.githubusercontent.com/57691894/129868348-6b5a3175-dfd9-46d6-ba24-d581a7050268.png)

### 플러딩

컴퓨터1에서 컴퓨터3에 데이터를 전송한 시점에는 목적지인 컴퓨터3의 MAC주소가 MAC 주소 테이블에 등록되어 있지 않기 때문에 포트 1 이외의 모든 포트에 데이터(프레임)가 전송되는데 이를 플러딩이라고 한다.

### MAC 주소 필터링

MAC 주소가 등록되어 있으면 목적지 컴퓨터에만 데이터가 전송된다. 이처럼 MAC 주소를 기준으로 목적지를 선택하는 것을 MAC 주소 필터링이라고 한다. 불필요한 데이터 전송을 막는다.


# 15 데이터가 케이블에서 충돌하지 않는 구조

### 전이중 통신 방식

데이터의 송수신을 동시에 통신하는 방식

데이터를 동시에 전송해도 충돌이 발생하지 않는다

![https://user-images.githubusercontent.com/57691894/130087519-09f665dd-f9f0-448f-bfaf-9582331cd42f.png](https://user-images.githubusercontent.com/57691894/130087519-09f665dd-f9f0-448f-bfaf-9582331cd42f.png)

컴퓨터 간을 직접 랜 케이블로 연결하는 방식이 전이중 통신 방식이다.

### 반이중 통신 방식

회선 하나로 송신과 수신을 번갈아면서 통신하는 방식

데이터를 동시에 전송하면 충돌이 발생한다

- **허브** 내부에는 송수신이 나누어져 있지 않기 때문에 동시에 데이터를 보낼 때 충돌이 일어난다. 때문에 반이중 통신 방식을 사용한다.
- **스위치**는 충돌이 일어나지 않는 구조로 되어 있기 때문에 전이중 통신 방식을 사용한다.

→ 최근에는 네트워크로 스위치를 사용하는 것이 표준!

### 충돌 도메인

반이중 통신 방식으로 동시에 데이터를 전송했을 때 발생하는 충돌이 미치는 범위를 충돌 도메인(collision domain)이라고 한다.

- **허브**는 연결되어 있는 모든 컴퓨터에 충돌의 영향이 미치므로 컴퓨터 전체가 하나의 충돌 도메인이다.
- **스위치**는 충돌이 발생하지 않기 때문에 충돌 도메인의 범위는 당해 컴퓨터 하나에 국한된다.

→ 충돌 도메인의 범위가 넓을수록 네트워크가 지연되기 때문에 충돌 도메인의 범위를 좁히는 것이 매우 중요하다.


# 16 이더넷의 종류와 특징

### 이더넷 규격

이더넷은 케이블 종류나 통신 속도에 따라 다양한 규격으로 분류된다.

|규격 이름|통신 속도|케이블|케이블 최대 길이|표준화 연도|
|:------:|:---:|:---:|:---:|:---:|
|10BASE5|10Mbps|동축케이블|500m|1982|
|10BASE2|10Mbps|동축케이블|185m|1988|
|10BASE-T|10Mbps|UTP케이블(Cat3이상)|100m|1990|
|100BASE-TX|100Mbps|UTP케이블(Cat5이상)|100m|1995|
|1000BASE-T|1000Mbps|UTP케이블(Cat5이상)|100m|1999|
|10GBASE-T|10Gbps|UTP케이블(Cat6a이상)|100m|2006|


### 규격 이름의 뜻

|10 | BASE | - T|
|:---:|:---:|:---:|
|통신속도| 전송방식 | 케이블 종류|

- 통신속도 : 10은 10Mbps라는 뜻
- 전송방식 : BASE는 BASEBAND라는 전송방식을 의미
    - BASEBAND : 펄스 신호에 의한 디지털 전송방식
- 케이블 종류 : 하이픈(-) 뒤는 케이블 길이나 케이블 종류를 나타내지만 동축케이블은 케이블의 최대 길이를 100미터 단위로 표시한다.

→ 최근 랜 포트는 1000BASE-T가 일반적이다. (2018.6.기준)
