## 1. 노드 시작하기

### 1.1 핵심 개념

Node.js는 크롬V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타임.

### 1.1.1 서버

서버는 네트워크를 통해 클라이언트에 정보나 서비스를 제공하는 컴퓨터 또는 프로그램을 말한다. 노드는 자바스크립트 애플리케이션이 서버로서 기능하기 위한 도구를 제공하므로 서버 역할을 수행할 수 있다.

### 1.1.2 자바스크립트 런타임

런타임은 특정 언어로 만든 프로그램들을 실행할 수 있는 환경을 뜻한다. 즉, 노드는 자바스크립트 프로그램을 컴퓨터에서 실행할 수 있게 해준다. 노드는 빠른 속도의 V8 엔진과 더불어 libuv 라이브러리를 사용한다. libuv 라이브러리는 노드의 특성인 이벤트 기반, 논블로킹 I/O 모델을 구현하고 있다.

![nodejs](https://user-images.githubusercontent.com/57691894/111168208-31890380-85e5-11eb-947c-8295d0e4ccc9.jpg)
노드의 내부 구조

### 1.1.3 이벤트 기반

이벤트 기반(event-driven)이란 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식을 의미한다. 클릭이나 네트워크 요청 등을 예로 들 수 있다.

이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할지 미리 등록해두어야 한다. 이것을 이벤트 리스너에 콜백 함수를 등록한다고 말한다.

- 이벤트 루프 : 이벤트 발생 시 호출할 콜백 함수들을 관리하고, 호출된 콜백 함수의 실행 순서를 결정하는 일을 한다. 노드가 종료될 때까지 이벤트 처리를 위한 작업을 반복하므로 루프라고 불린다.
- 태스크 큐 : 이벤트 발생 후 호출되어야 할 콜백 함수들이 기다리는 공간. 이벤트 루프가 정한 순서대로 콜백들이 줄을 서 있어서 콜백 큐라고도 불린다.
- 백그라운드 : 타이머나 I/O 작업 콜백 또는 이벤트 리스너들이 대기하는 곳.

![event-loop](https://user-images.githubusercontent.com/57691894/111168204-3057d680-85e5-11eb-8e37-f092ad31aab7.png)

### 1.1.4 논블로킹I/O

I/O는 입력/출력을 의미한다. 파일 시스템 접근(파일 읽기, 쓰기, 폴더 만들기 등)이나 네트워크 요청 같은 작업이 I/O의 일종이다. 이러한 작업을 할 때 노드는 논블로킹 방식으로 동작한다. 논블로킹이란 이전 작업이 완료될 때까지 멈추지 않고 다음 작업을 수행함을 뜻한다. 이벤트 루프를 통해 오래 걸리는 함수를 백그라운드로 보내서 다음 코드가 먼저 실행되게 하고, 그 함수가 다시 태스크 큐를 거쳐 호출 스택으로 올라오기를 기다리게 한다.

### 1.1.5 싱글 스레드

노드는 싱글 스레드이므로 주어진 작업을 혼자서 처리해야 한다. 반대로 멀티 스레드인 시스템에서는 여러 개의 스레드가 일을 나눠서 처리할 수 있다.

자바스크립트와 노드에서 논블로킹이 중요한 이유는 바로 싱글 스레드이기 때문이다. 한 번에 한 가지 일밖에 처리하지 못하므로 어떤 작업에서 블로킹이 발생하면 다음 일을 처리하지 못한다.

노드도 싱글 스레드 여러 개를 사용해 멀티 스레딩과 비슷한 기능을 하게 할 수 있지만, 엄밀히 말하면 멀티 프로세싱에 가깝다.

- 프로세스 : 운영체제에서 할당하는 작업의 단위. 노드나 인터넷 브라우저 같은 프로그램은 개별적인 프로세스이다. 프로세스 간에는 메모리 등의 자원을 공유하지 않는다.
- 스레드 : 프로세스 내에서 실행되는 흐름의 단위. 하나의 프로세스는 스레드를 여러 개 가질 수 있다. 스레드들은 부모 프로세스의 자원을 공유한다.(=같은 메모리에 접근 가능)

노드는 스레드를 늘리는 대신, 프로세스 자체를 복사해 여러 작업을 동시에 처리하는 멀티 프로세싱 방식을 택했다. 자바스크립트 언어 자체가 싱글 스레드 특성을 띠고 있기 때문이다.

### 1.2 서버로서의 노드

- 장점

  멀티 스레드 방식에 비해 컴퓨터 자원을 적게 사용함

  I/O 작업이 많은 서버로 적합

  멀티 스레드 방식보다 쉬움

  웹 서버가 내장되어 있음

  자바스크립트를 사용함

  JSON 형식과 호환하기 쉬움

- 단점

  싱글 스레드라서 CPU코어를 하나만 사용함

  CPU 작업이 많은 서버로는 부적합

  하나뿐인 스레드가 멈추지 않도록 관리해야 함

  서버 규모가 커졌을 때 서버 관리 어려움

  어중간한 성능

### 1.3 서버 외의 노드

노드는 웹, 모바일, 데스크톱 애플리케이션 개발에도 사용된다. 노드 기반으로 돌아가는 대표적인 웹 프레임워크로는 Angular, React, Vue, Meteor 등이 있다. 데스크톱 개발 도구로는 Electron이 대표적이다.

---
공부 참고 도서 : Node.js 교과서 -조현영(길벗)
