## 현상

서버 로그를 확인해보니 서버를 기동하면 db 접속이 안되는 에러가 발생했다. 로그에 에러 메시지가 남지도 않고 계속 connection을 무한대기하는 상황이었다. 

## 분석

어제까지만 해도 잘되던 코드였는데 갑자기 문제가 발생하니 이해가 되지 않았다. MongoDB를 이용중이었는데 해당 atlas 자체의 문제라고밖에 생각되지 않았다. 그러나 mongo shell로는 접속이 되는 것을 확인하고 나서는 더더욱 미궁으로 빠져들었다.

- **init.js**

![init](https://user-images.githubusercontent.com/57691894/113498736-ae572f80-954a-11eb-8330-d6015112d678.PNG)

- **db.js**

![db](https://user-images.githubusercontent.com/57691894/113498735-ae572f80-954a-11eb-923b-50ff2a038a4b.PNG)

## 해결

늘 그렇듯 황당하게도 해결은 간단했다. 매 라인마다 console.log를 찍어서 확인하던 중에 db.js 코드가 전혀 실행되지 않는 사실을 발견했다.

결국 init.js 에서 db.js를 import하고 있지 않아서 발생한 문제였다. 애초에 DB 접속을 시도조차 하지 않고 있었던 것이다. 그리고 불현듯 스쳐지나가는 어제의 기억. 

불필요한 코드를 지우는 작업을 했는데 이때 5번 라인에 불이 꺼져있는 것을 보고 음 필요 없군~ 하면서 지웠었다. 웃긴 게 같은 이유로 1번 라인도 지웠어야 맞는 건데 그건 왠지 필요해보여서 안 지웠었다. 얄팍함이 드러나는 지점이다. 필요한 건 5번 라인뿐만 아니라 nodejs 기초였다.

- **Init.js**

![init-db](https://user-images.githubusercontent.com/57691894/113498733-ad260280-954a-11eb-9c49-edffc6e8ce5b.PNG)

다시 5번 라인의 코드를 추가해줌으로써 문제는 해결되었다.
